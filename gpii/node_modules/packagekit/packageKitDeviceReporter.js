/**
 * GPII PackageKit Device Reporter
 *
 * Copyright 2014 Emergya
 *
 * Licensed under the New BSD license. You may not use this file except in
 * compliance with this License.
 *
 * You may obtain a copy of the License at
 * https://github.com/GPII/linux/blob/master/LICENSE.txt
 *
 * The research leading to these results has received funding from the European Union's
 * Seventh Framework Programme (FP7/2007-2013)
 * under grant agreement no. 289016.
 */

"use strict";

var fluid = require("gpii-universal");
var gpii = fluid.registerNamespace("gpii");
var packageKit = require("./nodepackagekit/build/Release/nodepackagekit.node");

fluid.registerNamespace("gpii.packageKit");

fluid.defaults("gpii.packageKit.get", {
    gradeNames: "fluid.function",
    argumentMap: {
        filters: 0
    }
});

gpii.packageKit.get = function (filters) {
    return {
        "id": "gpii.packageKit",
        "data": packageKit.getPackages(filters)
    };
};

fluid.defaults("gpii.packageKit.find", {
    gradeNames: "fluid.function",
    argumentMap: {
        name: 0
    }
});

gpii.packageKit.find = function (name) {
    return gpii.packageKit.installedPackagesCache.some(function (pkg) {
        return pkg.name === name;
    });
};

